
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
        <link rel="next" href="api_reference/">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.28">
    
    
      
        <title>makefun</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.6543a935.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#makefun" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="makefun" class="md-header__button md-logo" aria-label="makefun" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            makefun
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Home
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/smarie/python-makefun" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="makefun" class="md-nav__button md-logo" aria-label="makefun" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    makefun
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/smarie/python-makefun" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Home
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installing" class="md-nav__link">
    <span class="md-ellipsis">
      Installing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    <span class="md-ellipsis">
      Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-ex-nihilo-creation" class="md-nav__link">
    <span class="md-ellipsis">
      1- Ex-nihilo creation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1- Ex-nihilo creation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arguments-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments mapping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#more-compact-syntax" class="md-nav__link">
    <span class="md-ellipsis">
      More compact syntax
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pep484-type-hints-in-str" class="md-nav__link">
    <span class="md-ellipsis">
      PEP484 type hints in str
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-signature-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Using Signature objects
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-deriving-from-existing-signatures" class="md-nav__link">
    <span class="md-ellipsis">
      2- Deriving from existing signatures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2- Deriving from existing signatures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#copying-a-signature" class="md-nav__link">
    <span class="md-ellipsis">
      Copying a signature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signature-preserving-function-wrappers" class="md-nav__link">
    <span class="md-ellipsis">
      Signature-preserving function wrappers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#editing-a-signature" class="md-nav__link">
    <span class="md-ellipsis">
      Editing a signature
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Editing a signature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#easier-edits" class="md-nav__link">
    <span class="md-ellipsis">
      Easier edits
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removing-parameters-easily" class="md-nav__link">
    <span class="md-ellipsis">
      Removing parameters easily
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Removing parameters easily">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to-replace-them-with-a-hardcoded-value" class="md-nav__link">
    <span class="md-ellipsis">
      To replace them with a hardcoded value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-inject-a-dynamically-baked-value" class="md-nav__link">
    <span class="md-ellipsis">
      To inject a dynamically baked value
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-advanced-topics" class="md-nav__link">
    <span class="md-ellipsis">
      3- Advanced topics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3- Advanced topics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generators-and-coroutines" class="md-nav__link">
    <span class="md-ellipsis">
      Generators and Coroutines
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generated-source-code" class="md-nav__link">
    <span class="md-ellipsis">
      Generated source code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-reference-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Function reference injection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-other-goodies" class="md-nav__link">
    <span class="md-ellipsis">
      4. Other goodies
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Other goodies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compile_fun" class="md-nav__link">
    <span class="md-ellipsis">
      @compile_fun
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main-features-benefits" class="md-nav__link">
    <span class="md-ellipsis">
      Main features / benefits
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
    <nav class="md-nav" aria-label="See Also">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#others" class="md-nav__link">
    <span class="md-ellipsis">
      Others
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#want-to-contribute" class="md-nav__link">
    <span class="md-ellipsis">
      Want to contribute ?
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="api_reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API reference
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installing" class="md-nav__link">
    <span class="md-ellipsis">
      Installing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    <span class="md-ellipsis">
      Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-ex-nihilo-creation" class="md-nav__link">
    <span class="md-ellipsis">
      1- Ex-nihilo creation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1- Ex-nihilo creation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arguments-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments mapping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#more-compact-syntax" class="md-nav__link">
    <span class="md-ellipsis">
      More compact syntax
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pep484-type-hints-in-str" class="md-nav__link">
    <span class="md-ellipsis">
      PEP484 type hints in str
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-signature-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Using Signature objects
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-deriving-from-existing-signatures" class="md-nav__link">
    <span class="md-ellipsis">
      2- Deriving from existing signatures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2- Deriving from existing signatures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#copying-a-signature" class="md-nav__link">
    <span class="md-ellipsis">
      Copying a signature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signature-preserving-function-wrappers" class="md-nav__link">
    <span class="md-ellipsis">
      Signature-preserving function wrappers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#editing-a-signature" class="md-nav__link">
    <span class="md-ellipsis">
      Editing a signature
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Editing a signature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#easier-edits" class="md-nav__link">
    <span class="md-ellipsis">
      Easier edits
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removing-parameters-easily" class="md-nav__link">
    <span class="md-ellipsis">
      Removing parameters easily
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Removing parameters easily">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to-replace-them-with-a-hardcoded-value" class="md-nav__link">
    <span class="md-ellipsis">
      To replace them with a hardcoded value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-inject-a-dynamically-baked-value" class="md-nav__link">
    <span class="md-ellipsis">
      To inject a dynamically baked value
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-advanced-topics" class="md-nav__link">
    <span class="md-ellipsis">
      3- Advanced topics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3- Advanced topics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generators-and-coroutines" class="md-nav__link">
    <span class="md-ellipsis">
      Generators and Coroutines
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generated-source-code" class="md-nav__link">
    <span class="md-ellipsis">
      Generated source code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-reference-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Function reference injection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-other-goodies" class="md-nav__link">
    <span class="md-ellipsis">
      4. Other goodies
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Other goodies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compile_fun" class="md-nav__link">
    <span class="md-ellipsis">
      @compile_fun
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main-features-benefits" class="md-nav__link">
    <span class="md-ellipsis">
      Main features / benefits
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
    <nav class="md-nav" aria-label="See Also">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#others" class="md-nav__link">
    <span class="md-ellipsis">
      Others
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#want-to-contribute" class="md-nav__link">
    <span class="md-ellipsis">
      Want to contribute ?
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="makefun">makefun<a class="headerlink" href="#makefun" title="Permanent link">&para;</a></h1>
<p><em>Dynamically create python functions with a proper signature.</em></p>
<p><a href="https://pypi.python.org/pypi/makefun/"><img alt="Python versions" src="https://img.shields.io/pypi/pyversions/makefun.svg" /></a> <a href="https://github.com/smarie/python-makefun/actions/workflows/base.yml"><img alt="Build Status" src="https://github.com/smarie/python-makefun/actions/workflows/base.yml/badge.svg" /></a> <a href="reports/junit/report.html"><img alt="Tests Status" src="reports/junit/junit-badge.svg?dummy=8484744" /></a> <a href="reports/coverage/"><img alt="Coverage Status" src="reports/coverage/coverage-badge.svg?dummy=8484744" /></a> <a href="https://codecov.io/gh/smarie/python-makefun"><img alt="codecov" src="https://codecov.io/gh/smarie/python-makefun/branch/main/graph/badge.svg" /></a> <a href="reports/flake8/"><img alt="Flake8 Status" src="reports/flake8/flake8-badge.svg?dummy=8484744" /></a></p>
<p><a href="https://smarie.github.io/python-makefun/"><img alt="Documentation" src="https://img.shields.io/badge/doc-latest-blue.svg" /></a> <a href="https://pypi.python.org/pypi/makefun/"><img alt="PyPI" src="https://img.shields.io/pypi/v/makefun.svg" /></a> <a href="https://pepy.tech/project/makefun"><img alt="Downloads" src="https://pepy.tech/badge/makefun" /></a> <a href="https://pepy.tech/project/makefun"><img alt="Downloads per week" src="https://pepy.tech/badge/makefun/week" /></a> <a href="https://github.com/smarie/python-makefun/stargazers"><img alt="GitHub stars" src="https://img.shields.io/github/stars/smarie/python-makefun.svg" /></a></p>
<div class="admonition success">
<p class="admonition-title">New <code>prepend_args</code>, <code>append_args</code>, and <code>remove_args</code> parameters in <a href="api_reference/#wraps"><code>@wraps</code></a>. See <a href="#easier-edits">below</a> for details !</p>
</div>
<p><code>makefun</code> helps you create functions dynamically, with the signature of your choice. It was largely inspired by <a href="https://github.com/micheles/decorator"><code>decorator</code></a> and <code>functools</code>, and created mainly to cover some of their limitations.</p>
<p>The typical use cases are:</p>
<ul>
<li>
<p>creating <a href="#signature-preserving-function-wrappers"><strong>signature-preserving function wrappers</strong></a> - just like <code>functools.wraps</code> but with accurate <code>TypeError</code> exception raising when user-provided arguments are wrong, and with a very convenient way to access argument values.</p>
</li>
<li>
<p>creating <strong>function wrappers that have more or less arguments</strong> that the function they wrap. A bit like <code>functools.partial</code> but a lot more flexible and friendly for your users. For example, I use it in <a href="https://github.com/smarie/OVERVIEW#tests">my pytest plugins</a> to add a <code>requests</code> parameter to users' tests or fixtures when they do not already have it.</p>
</li>
<li>
<p>more generally, creating <strong>functions with a signature derived from a reference signature</strong>,</p>
</li>
<li>
<p>or even creating <strong>functions with a signature completely defined at runtime</strong>.</p>
</li>
</ul>
<p>It currently supports three ways to define the signature of the created function</p>
<ul>
<li>from a given reference function, e.g. <code>foo</code>.</li>
<li>from strings, e.g. <code>'foo(a, b=1)'</code></li>
<li>from <code>Signature</code> objects, either manually created, or obtained by using the <code>inspect.signature</code> (or its backport <code>funcsigs.signature</code>) method.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">creating signature-preserving decorators</p>
<p>Creating decorators and creating signature-preserving function wrappers are two independent problems. <code>makefun</code> is solely focused on the second problem. If you wish to solve the first problem you can look at <a href="https://smarie.github.io/python-decopatch/"><code>decopatch</code></a>. It provides a compact syntax, relying on <code>makefun</code>, if you wish to tackle both at once.</p>
</div>
<h2 id="installing">Installing<a class="headerlink" href="#installing" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>&gt;<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>makefun
</code></pre></div>
<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<h3 id="1-ex-nihilo-creation">1- Ex-nihilo creation<a class="headerlink" href="#1-ex-nihilo-creation" title="Permanent link">&para;</a></h3>
<p>Let's create a function <code>foo(b, a=0)</code> implemented by <code>func_impl</code>. The easiest way to provide the signature is as a <code>str</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">makefun</span> <span class="kn">import</span> <span class="n">create_function</span>

<span class="c1"># (1) define the signature. Warning: do not put &#39;def&#39; keyword here!</span>
<span class="n">func_sig</span> <span class="o">=</span> <span class="s2">&quot;foo(b, a=0)&quot;</span>

<span class="c1"># (2) define the function implementation</span>
<span class="k">def</span> <span class="nf">func_impl</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This docstring will be used in the generated function by default&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;func_impl called !&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span>

<span class="c1"># (3) create the dynamic function</span>
<span class="n">gen_func</span> <span class="o">=</span> <span class="n">create_function</span><span class="p">(</span><span class="n">func_sig</span><span class="p">,</span> <span class="n">func_impl</span><span class="p">)</span>
</code></pre></div>
<p>We can test it:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">gen_func</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">func_impl</span> <span class="n">called</span> <span class="err">!</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">assert</span> <span class="n">args</span> <span class="o">==</span> <span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">assert</span> <span class="n">kwargs</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
</code></pre></div>
<p>You can also:</p>
<ul>
<li>remove the name from the signature string (e.g. <code>'(b, a=0)'</code>) to directly use the function name of <code>func_impl</code>.</li>
<li>override the function name, docstring, qualname and module name if you pass a non-None <code>func_name</code>, <code>doc</code>, <code>qualname</code> and <code>module_name</code> argument</li>
<li>add other attributes on the generated function if you pass additional keyword arguments</li>
</ul>
<p>See <a href="api_reference/#create_function">API reference</a> for details.</p>
<h4 id="arguments-mapping">Arguments mapping<a class="headerlink" href="#arguments-mapping" title="Permanent link">&para;</a></h4>
<p>We can see above that <code>args</code> is empty, even if we called <code>gen_func</code> with a positional argument. This is completely normal: this is because the created function does not expose <code>(*args, **kwargs)</code> but exposes the desired signature <code>(b, a=0)</code>. So as for usual python function calls, we lose the information about what was provided as positional and what was provided as keyword. You can try it yourself: write a function <code>def foo(b, a=0)</code> and now try to guess from the function body what was provided as positional, and what was provided as keyword...</p>
<p>This behaviour is actually a great feature because it makes it much easier to develop the <code>func_impl</code>! Indeed, except if your desired signature contains <em>positional-only</em> (not yet available as of python 3.7) or <em>var-positional</em> (e.g. <code>*args</code>) arguments, you will <strong>always</strong> find all named arguments in <code>**kwargs</code>.</p>
<h4 id="more-compact-syntax">More compact syntax<a class="headerlink" href="#more-compact-syntax" title="Permanent link">&para;</a></h4>
<p>You can use the <a href="api_reference/#with_signature"><code>@with_signature</code></a> decorator to perform exactly the same things than <a href="api_reference/#create_function"><code>create_function</code></a>, but in a more compact way:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">makefun</span> <span class="kn">import</span> <span class="n">with_signature</span>

<span class="nd">@with_signature</span><span class="p">(</span><span class="s2">&quot;foo(b, a=0)&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">gen_func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This docstring will be used in the generated function by default&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;func_impl called !&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span>
</code></pre></div>
<p>It also has the capability to take <code>None</code> as a signature, if you just want to update the metadata (<code>func_name</code>, <code>doc</code>, <code>qualname</code>, <code>module_name</code>) without creating any function:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@with_signature</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">func_name</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span>

<span class="k">assert</span> <span class="n">foo</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span>
</code></pre></div>
<p>See <a href="api_reference/#with_signature">API reference</a> for details.</p>
<h4 id="pep484-type-hints-in-str">PEP484 type hints in <code>str</code><a class="headerlink" href="#pep484-type-hints-in-str" title="Permanent link">&para;</a></h4>
<p>PEP484 type hints are supported in string function definitions:</p>
<div class="highlight"><pre><span></span><code><span class="n">func_sig</span> <span class="o">=</span> <span class="s2">&quot;foo(b: int, a: float = 0) -&gt; str&quot;</span>
</code></pre></div>
<p>PEP484 type comments are also supported:</p>
<div class="highlight"><pre><span></span><code><span class="n">func_signature</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">foo(b,      # type: int</span>
<span class="s2">    a = 0,  # type: float</span>
<span class="s2">    ):</span>
<span class="s2">    # type: (...) -&gt; str</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>
<p>but unfortunately <code>inspect.signature</code> is not able to detect them so the generated function does not contain the annotations. See <a href="https://github.com/smarie/python-makefun/issues/7#issuecomment-459353197">this example</a>. </p>
<h4 id="using-signature-objects">Using <code>Signature</code> objects<a class="headerlink" href="#using-signature-objects" title="Permanent link">&para;</a></h4>
<p><a href="api_reference/#create_function"><code>create_function</code></a> and <a href="api_reference/#with_signature"><code>@with_signature</code></a> are able to accept a <code>Signature</code> object as input, instead of a <code>str</code>. That might be more convenient than using strings to programmatically define signatures. For example we can rewrite the above script using <code>Signature</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">makefun</span> <span class="kn">import</span> <span class="n">with_signature</span>
<span class="kn">from</span> <span class="nn">inspect</span> <span class="kn">import</span> <span class="n">Signature</span><span class="p">,</span> <span class="n">Parameter</span>

<span class="c1"># (1) define the signature using objects.</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">[</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">Parameter</span><span class="o">.</span><span class="n">POSITIONAL_OR_KEYWORD</span><span class="p">),</span>
              <span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">Parameter</span><span class="o">.</span><span class="n">POSITIONAL_OR_KEYWORD</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="p">]</span>
<span class="n">func_sig</span> <span class="o">=</span> <span class="n">Signature</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
<span class="n">func_name</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span>

<span class="c1"># (2) define the function</span>
<span class="nd">@with_signature</span><span class="p">(</span><span class="n">func_sig</span><span class="p">,</span> <span class="n">func_name</span><span class="o">=</span><span class="n">func_name</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">gen_func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This docstring will be used in the generated function by default&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;func_impl called !&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span>
</code></pre></div>
<p>Note that <code>Signature</code> objects do not contain any function name information. You therefore have to provide an explicit <code>func_name</code> argument to <a href="api_reference/#with_signature"><code>@with_signature</code></a> (or to <a href="api_reference/#create_function"><code>create_function</code></a>) as shown above.</p>
<div class="admonition note">
<p class="admonition-title"><code>Signature</code> availability in python 2</p>
<p>In python 2 the <code>inspect</code> package does not provide any signature-related features, but a complete backport is available: <a href="https://github.com/testing-cabal/funcsigs"><code>funcsigs</code></a>.</p>
</div>
<h3 id="2-deriving-from-existing-signatures">2- Deriving from existing signatures<a class="headerlink" href="#2-deriving-from-existing-signatures" title="Permanent link">&para;</a></h3>
<p>In many real-world applications we want to reuse "as is", or slightly modify, an existing signature.</p>
<h4 id="copying-a-signature">Copying a signature<a class="headerlink" href="#copying-a-signature" title="Permanent link">&para;</a></h4>
<p>If you just want to expose the same signature as a reference function (and not wrap it nor appear like it), the easiest way to copy the signature from another function <code>f</code> is to use <code>signature(f)</code> from <code>inspect</code>/<code>funcsigs</code>.</p>
<h4 id="signature-preserving-function-wrappers">Signature-preserving function wrappers<a class="headerlink" href="#signature-preserving-function-wrappers" title="Permanent link">&para;</a></h4>
<p><a href="https://docs.python.org/3/library/functools.html#functools.wraps"><code>@functools.wraps</code></a> is a famous decorator to create "signature-preserving" function wrappers. However it does not actually preserve the signature, it just uses a trick (setting the <code>__wrapped__</code> attribute) to trigger special dedicated behaviour in <code>stdlib</code>'s <code>help()</code> and <code>signature()</code> methods. See <a href="https://stackoverflow.com/questions/308999/what-does-functools-wraps-do/55102697#55102697">here</a>.</p>
<p>This has two major limitations: </p>
<ol>
<li>the wrapper code will execute <em>even when the provided arguments are invalid</em>. </li>
<li>the wrapper code can not easily access an argument using its name, from the received <code>*args, **kwargs</code>. Indeed one would have to handle all cases (positional, keyword, default) and therefore to use something like <code>Signature.bind()</code>.</li>
</ol>
<p><code>makefun</code> provides a convenient replacement for <a href="api_reference/#wraps"><code>@wraps</code></a> that fixes these two issues:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">makefun</span> <span class="kn">import</span> <span class="n">wraps</span>

<span class="c1"># a dummy function</span>
<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; foo doc &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="c1"># our signature-preserving wrapper</span>
<span class="nd">@wraps</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">enhanced_foo</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;hello!&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;b=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>  <span class="c1"># we can reliably access &#39;b&#39;</span>
    <span class="k">return</span> <span class="n">foo</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
<p>We can check that the wrapper behaves correctly whatever the call modes:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">assert</span> <span class="n">enhanced_foo</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>  <span class="c1"># positional &#39;b&#39;</span>
<span class="n">hello</span><span class="err">!</span>
<span class="n">b</span><span class="o">=</span><span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">assert</span> <span class="n">enhanced_foo</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>  <span class="c1"># keyword &#39;b&#39;</span>
<span class="n">hello</span><span class="err">!</span>
<span class="n">b</span><span class="o">=</span><span class="mi">0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">assert</span> <span class="n">enhanced_foo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>  <span class="c1"># default &#39;b&#39;</span>
<span class="n">hello</span><span class="err">!</span>
<span class="n">b</span><span class="o">=</span><span class="mi">1</span>
</code></pre></div>
<p>And let's pass wrong arguments to it: we see that the wrapper is <strong>not</strong> executed.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">enhanced_foo</span><span class="p">()</span>
<span class="ne">TypeError</span><span class="p">:</span> <span class="n">foo</span><span class="p">()</span> <span class="n">missing</span> <span class="mi">1</span> <span class="n">required</span> <span class="n">positional</span> <span class="n">argument</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span>
</code></pre></div>
<p>You can try to do the same experiment with <code>functools.wraps</code> to see the difference.</p>
<p>Finally note that a <a href="api_reference/#create_wrapper"><code>create_wrapper</code></a> function is also provided for convenience ; it is the equivalent of <a href="api_reference/#wraps"><code>@wraps</code></a> but as a standard function - not a decorator.</p>
<div class="admonition note">
<p class="admonition-title">creating signature-preserving decorators</p>
<p>Creating decorators and creating signature-preserving function wrappers are two independent problems. <code>makefun</code> is solely focused on the second problem. If you wish to solve the first problem you can look at <a href="https://smarie.github.io/python-decopatch/"><code>decopatch</code></a>. It provides a compact syntax, relying on <code>makefun</code>, if you wish to tackle both at once.</p>
</div>
<h4 id="editing-a-signature">Editing a signature<a class="headerlink" href="#editing-a-signature" title="Permanent link">&para;</a></h4>
<p>Below we show how to add a parameter to a function. We first capture its <code>Signature</code> using <code>inspect.signature(f)</code>, we modify it to add a parameter, and finally we use it in <code>wraps</code> to create our final function:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">makefun</span> <span class="kn">import</span> <span class="n">wraps</span>
<span class="kn">from</span> <span class="nn">inspect</span> <span class="kn">import</span> <span class="n">signature</span><span class="p">,</span> <span class="n">Parameter</span>

<span class="c1"># (0) the reference function</span>
<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;foo called: b=</span><span class="si">%s</span><span class="s2">, a=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span>

<span class="c1"># (1a) capture the signature of reference function `foo`</span>
<span class="n">foo_sig</span> <span class="o">=</span> <span class="n">signature</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original Signature: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">foo_sig</span><span class="p">)</span>

<span class="c1"># (1b) modify the signature to add a new parameter &#39;z&#39; as first argument</span>
<span class="n">params</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">foo_sig</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="n">params</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">Parameter</span><span class="o">.</span><span class="n">POSITIONAL_OR_KEYWORD</span><span class="p">))</span>
<span class="n">new_sig</span> <span class="o">=</span> <span class="n">foo_sig</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;New Signature: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">new_sig</span><span class="p">)</span>

<span class="c1"># (2) define the wrapper implementation</span>
<span class="nd">@wraps</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">new_sig</span><span class="o">=</span><span class="n">new_sig</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">foo_wrapper</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;foo_wrapper called ! z=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">z</span><span class="p">)</span>
    <span class="c1"># call the foo function </span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">foo</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># return augmented output</span>
    <span class="k">return</span> <span class="n">z</span><span class="p">,</span> <span class="n">output</span>

<span class="c1"># call it</span>
<span class="k">assert</span> <span class="n">foo_wrapper</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</code></pre></div>
<p>yields</p>
<div class="highlight"><pre><span></span><code>Original Signature: (b, a=0)
New Signature: (z, b, a=0)

foo_wrapper called ! z=3
foo called: b=2, a=0
</code></pre></div>
<p>This way you can therefore easily create function wrappers with different signatures: not only adding, but also removing parameters, changing their kind (forcing keyword-only for example), etc. The possibilities are as endless as the capabilities of the <code>Signature</code> objects.</p>
<p>Two helper functions are provided in this toolbox to make it a bit easier for you to edit <code>Signature</code> objects:</p>
<ul>
<li><a href="api_reference/#remove_signature_parameters"><code>remove_signature_parameters</code></a> creates a new signature from an existing one by removing all parameters corresponding to the names provided</li>
<li><a href="api_reference/#add_signature_parameters"><code>add_signature_parameters</code></a> prepends the <code>Parameter</code>s provided in its <code>first=</code> argument, and appends the ones provided in its <code>last</code> argument.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">makefun</span> <span class="kn">import</span> <span class="n">add_signature_parameters</span><span class="p">,</span> <span class="n">remove_signature_parameters</span>

<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="c1"># original signature</span>
<span class="n">foo_sig</span> <span class="o">=</span> <span class="n">signature</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;original signature: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">foo_sig</span><span class="p">)</span>

<span class="c1"># let&#39;s modify it</span>
<span class="n">new_sig</span> <span class="o">=</span> <span class="n">add_signature_parameters</span><span class="p">(</span><span class="n">foo_sig</span><span class="p">,</span>
                <span class="n">first</span><span class="o">=</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">Parameter</span><span class="o">.</span><span class="n">POSITIONAL_OR_KEYWORD</span><span class="p">),</span>
                <span class="n">last</span><span class="o">=</span><span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">Parameter</span><span class="o">.</span><span class="n">POSITIONAL_OR_KEYWORD</span><span class="p">,</span> 
                               <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
          <span class="p">)</span>
<span class="n">new_sig</span> <span class="o">=</span> <span class="n">remove_signature_parameters</span><span class="p">(</span><span class="n">new_sig</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;modified signature: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">new_sig</span><span class="p">)</span>
</code></pre></div>
<p>yields</p>
<div class="highlight"><pre><span></span><code>original<span class="w"> </span>signature:<span class="w"> </span><span class="o">(</span>b,<span class="w"> </span>c,<span class="w"> </span><span class="nv">a</span><span class="o">=</span><span class="m">0</span><span class="o">)</span>
modified<span class="w"> </span>signature:<span class="w"> </span><span class="o">(</span>z,<span class="w"> </span>c,<span class="w"> </span><span class="nv">o</span><span class="o">=</span>True<span class="o">)</span>
</code></pre></div>
<p>They might save you a few lines of code if your use-case is not too specific.</p>
<h5 id="easier-edits">Easier edits<a class="headerlink" href="#easier-edits" title="Permanent link">&para;</a></h5>
<p>Now <a href="api_reference/#wraps"><code>@wraps</code></a> supports three new parameters to easily add or remove parameters to a signature: <code>append_args</code>, <code>prepend_args</code>, and <code>remove_args</code>. The above example can therefore be simplified to</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">makefun</span> <span class="kn">import</span> <span class="n">wraps</span>

<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;foo called: b=</span><span class="si">%s</span><span class="s2">, a=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span>

<span class="nd">@wraps</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">prepend_args</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">foo_wrapper</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;foo_wrapper called ! z=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">z</span><span class="p">)</span>
    <span class="c1"># call the foo function </span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">foo</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># return augmented output</span>
    <span class="k">return</span> <span class="n">z</span><span class="p">,</span> <span class="n">output</span>

<span class="c1"># call it</span>
<span class="k">assert</span> <span class="n">foo_wrapper</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</code></pre></div>
<p>See <a href="api_reference/#wraps">api documentation</a> for details.</p>
<h4 id="removing-parameters-easily">Removing parameters easily<a class="headerlink" href="#removing-parameters-easily" title="Permanent link">&para;</a></h4>
<h5 id="to-replace-them-with-a-hardcoded-value">To replace them with a hardcoded value<a class="headerlink" href="#to-replace-them-with-a-hardcoded-value" title="Permanent link">&para;</a></h5>
<p>As goodies, <code>makefun</code> provides a <a href="api_reference/#partial"><code>partial</code></a> function that are equivalent to <a href="https://docs.python.org/2/library/functools.html#functools.partial"><code>functools.partial</code></a>, except that it is fully signature-preserving and modifies the documentation with a nice helper message explaining that this is a partial view:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    a `foo` function</span>

<span class="sd">    :param x:</span>
<span class="sd">    :param y:</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>

<span class="kn">from</span> <span class="nn">makefun</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="n">bar</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</code></pre></div>
<p>we can test it:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">assert</span> <span class="n">bar</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">13</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">help</span><span class="p">(</span><span class="n">bar</span><span class="p">)</span>
<span class="n">Help</span> <span class="n">on</span> <span class="n">function</span> <span class="n">bar</span> <span class="ow">in</span> <span class="n">module</span> <span class="n">makefun</span><span class="o">.</span><span class="n">tests</span><span class="o">.</span><span class="n">test_partial_and_macros</span><span class="p">:</span>

<span class="n">bar</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="o">&lt;</span><span class="n">This</span> <span class="n">function</span> <span class="ow">is</span> <span class="n">equivalent</span> <span class="n">to</span> <span class="s1">&#39;foo(y, x=12)&#39;</span><span class="p">,</span> <span class="n">see</span> <span class="n">original</span> <span class="s1">&#39;foo&#39;</span> <span class="n">doc</span> <span class="n">below</span><span class="o">.&gt;</span>

    <span class="n">a</span> <span class="err">`</span><span class="n">foo</span><span class="err">`</span> <span class="n">function</span>

    <span class="p">:</span><span class="n">param</span> <span class="n">x</span><span class="p">:</span>
    <span class="p">:</span><span class="n">param</span> <span class="n">y</span><span class="p">:</span>
    <span class="p">:</span><span class="k">return</span><span class="p">:</span>
</code></pre></div>
<p>A <a href="api_reference/#with_partial"><code>@with_partial</code></a> decorator is also available to create partial views easily for quick tests:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@with_partial</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    a `foo` function</span>

<span class="sd">    :param x:</span>
<span class="sd">    :param y:</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</code></pre></div>
<h5 id="to-inject-a-dynamically-baked-value">To inject a dynamically baked value<a class="headerlink" href="#to-inject-a-dynamically-baked-value" title="Permanent link">&para;</a></h5>
<p>As mentioned <a href="#easier-edits">previously</a>, <a href="api_reference/#wraps"><code>@wraps</code></a> provides a <code>remove_args</code> parameter where you can pass one or several argument names.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">inject_random_a</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator that injects a random number inside the `a` argument, </span>
<span class="sd">    removing it from the exposed signature</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">remove_args</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">my_wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># generate a random value for a and inject it in the args for f</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">my_wrapper</span>

<span class="nd">@inject_random_a</span>
<span class="k">def</span> <span class="nf">summer</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="k">assert</span> <span class="mi">12</span> <span class="o">&lt;=</span> <span class="n">summer</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">13</span>
</code></pre></div>
<h3 id="3-advanced-topics">3- Advanced topics<a class="headerlink" href="#3-advanced-topics" title="Permanent link">&para;</a></h3>
<h4 id="generators-and-coroutines">Generators and Coroutines<a class="headerlink" href="#generators-and-coroutines" title="Permanent link">&para;</a></h4>
<p><a href="api_reference/#create_function"><code>create_function</code></a> and <a href="api_reference/#with_signature"><code>@with_signature</code></a> will automatically create a generator if your implementation is a generator:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># define the implementation</span>
<span class="k">def</span> <span class="nf">my_generator_impl</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">i</span> <span class="o">*</span> <span class="n">i</span>

<span class="c1"># create the dynamic function</span>
<span class="n">gen_func</span> <span class="o">=</span> <span class="n">create_function</span><span class="p">(</span><span class="s2">&quot;foo(a, b)&quot;</span><span class="p">,</span> <span class="n">my_generator_impl</span><span class="p">)</span>

<span class="c1"># verify that the new function is a generator and behaves as such</span>
<span class="k">assert</span> <span class="n">isgeneratorfunction</span><span class="p">(</span><span class="n">gen_func</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">list</span><span class="p">(</span><span class="n">gen_func</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
</code></pre></div>
<p>The same goes for generator-based coroutines:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># define the impl that should be called</span>
<span class="k">def</span> <span class="nf">my_gencoroutine_impl</span><span class="p">(</span><span class="n">first_msg</span><span class="p">):</span>
    <span class="n">second_msg</span> <span class="o">=</span> <span class="p">(</span><span class="k">yield</span> <span class="n">first_msg</span><span class="p">)</span>
    <span class="k">yield</span> <span class="n">second_msg</span>

<span class="c1"># create the dynamic function</span>
<span class="n">gen_func</span> <span class="o">=</span> <span class="n">create_function</span><span class="p">(</span><span class="s2">&quot;foo(first_msg=&#39;hello&#39;)&quot;</span><span class="p">,</span> <span class="n">my_gencoroutine_impl</span><span class="p">)</span>

<span class="c1"># verify that the new func is a generator-based coroutine and behaves correctly</span>
<span class="n">cor</span> <span class="o">=</span> <span class="n">gen_func</span><span class="p">(</span><span class="s1">&#39;hi&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">next</span><span class="p">(</span><span class="n">cor</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;hi&#39;</span>
<span class="k">assert</span> <span class="n">cor</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;chaps&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;chaps&#39;</span>
<span class="n">cor</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;ola&#39;</span><span class="p">)</span>  <span class="c1"># raises StopIteration</span>
</code></pre></div>
<p>and asyncio coroutines as well</p>
<div class="highlight"><pre><span></span><code><span class="c1"># define the impl that should be called</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">my_native_coroutine_impl</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">):</span>
    <span class="k">await</span> <span class="n">sleep</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sleep_time</span>

<span class="c1"># create the dynamic function</span>
<span class="n">gen_func</span> <span class="o">=</span> <span class="n">create_function</span><span class="p">(</span><span class="s2">&quot;foo(sleep_time=2)&quot;</span><span class="p">,</span> <span class="n">my_native_coroutine_impl</span><span class="p">)</span>

<span class="c1"># verify that the new function is a native coroutine and behaves correctly</span>
<span class="kn">from</span> <span class="nn">asyncio</span> <span class="kn">import</span> <span class="n">get_event_loop</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">get_event_loop</span><span class="p">()</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">gen_func</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">out</span> <span class="o">==</span> <span class="mi">5</span>
</code></pre></div>
<h4 id="generated-source-code">Generated source code<a class="headerlink" href="#generated-source-code" title="Permanent link">&para;</a></h4>
<p>The generated source code is in the <code>__source__</code> field of the generated function:</p>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">gen_func</span><span class="o">.</span><span class="n">__source__</span><span class="p">)</span>
</code></pre></div>
<p>prints the following source code:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_func_impl_</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
</code></pre></div>
<p>The <code>_func_impl_</code> symbol represents your implementation. As <a href="#arguments_mapping">already mentioned</a>, you see that the variables are passed to it <em>as keyword arguments</em> when possible (<code>_func_impl_(b=b)</code>, not simply <code>_func_impl_(b)</code>). Of course if it is not possible it adapts:</p>
<div class="highlight"><pre><span></span><code><span class="n">gen_func</span> <span class="o">=</span> <span class="n">create_function</span><span class="p">(</span><span class="s2">&quot;foo(a=0, *args, **kwargs)&quot;</span><span class="p">,</span> <span class="n">func_impl</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gen_func</span><span class="o">.</span><span class="n">__source__</span><span class="p">)</span>
</code></pre></div>
<p>prints the following source code:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_func_impl_</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
<h4 id="function-reference-injection">Function reference injection<a class="headerlink" href="#function-reference-injection" title="Permanent link">&para;</a></h4>
<p>In some scenarios you may wish to share the same implementation among several created functions, for example to expose slightly different signatures on top of the same core.</p>
<p>In that case you may wish your implementation to know from which dynamically generated function it is being called. For this, simply use <code>inject_as_first_arg=True</code>, and the called function will be injected as the first argument:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">core_impl</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is generic core called by </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">f</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="c1"># here you could use f.__name__ in a if statement to determine what to do</span>
    <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;func1&quot;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;called from func1 !&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span>

<span class="c1"># generate 2 functions</span>
<span class="n">func1</span> <span class="o">=</span> <span class="n">create_function</span><span class="p">(</span><span class="s2">&quot;func1(a, b)&quot;</span><span class="p">,</span> <span class="n">core_impl</span><span class="p">,</span> <span class="n">inject_as_first_arg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">func2</span> <span class="o">=</span> <span class="n">create_function</span><span class="p">(</span><span class="s2">&quot;func2(a, d)&quot;</span><span class="p">,</span> <span class="n">core_impl</span><span class="p">,</span> <span class="n">inject_as_first_arg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">func1</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">func2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div>
<p>yields</p>
<div class="highlight"><pre><span></span><code>This is generic core called by func1
called from func1 !
This is generic core called by func2
</code></pre></div>
<h3 id="4-other-goodies">4. Other goodies<a class="headerlink" href="#4-other-goodies" title="Permanent link">&para;</a></h3>
<h4 id="compile_fun"><code>@compile_fun</code><a class="headerlink" href="#compile_fun" title="Permanent link">&para;</a></h4>
<p>A draft decorator to <code>compile</code> any existing function so that users cant debug through it. It can be handy to mask some code from your users for convenience (note that this does not provide any obfuscation, people can still reverse engineer your code easily. Actually the source code even gets copied in the function's <code>__source__</code> attribute for convenience):</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">makefun</span> <span class="kn">import</span> <span class="n">compile_fun</span>

<span class="nd">@compile_fun</span>
<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="k">assert</span> <span class="n">foo</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">foo</span><span class="o">.</span><span class="n">__source__</span><span class="p">)</span>
</code></pre></div>
<p>yields</p>
<div class="highlight"><pre><span></span><code>@compile_fun
def foo(a, b):
    return a + b
</code></pre></div>
<p>If the function closure includes functions, they are recursively replaced with compiled versions too (only for this closure, this does not modify them otherwise). You may disable this behaviour entirely with <code>recurse=False</code>, or exclude some symbols from this recursion with the <code>except_names=(...)</code> arg (a tuple of names to exclude).</p>
<p><strong>IMPORTANT</strong> this decorator is a "goodie" in early stage and has not been extensively tested. Feel free to contribute !</p>
<p>Note that according to <a href="https://stackoverflow.com/a/471227/7262247">this post</a> compiling does not make the code run any faster.</p>
<p>Known issues: <code>NameError</code> may appear if your function code depends on symbols that have not yet been defined. Make sure all symbols exist first ! See <a href="https://github.com/smarie/python-makefun/issues/47">this issue</a>.</p>
<h2 id="main-features-benefits">Main features / benefits<a class="headerlink" href="#main-features-benefits" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Generate functions with a dynamically defined signature</strong>: the signature can be provided as a string or as a <code>Signature</code> object, thus making it handy to derive from other functions.</li>
<li><strong>Implement them easily</strong>: the generated functions redirect their calls to the provided implementation function. As long as the signature is compliant, it will work as expected. For example the signature can be specific (<code>a: int, b=None</code>), and the implementation more generic (<code>*args, **kwargs</code>). Arguments will always be passed as keywords arguments when possible.</li>
<li>Replace <strong>`@functools.wraps</strong> so that it correctly preserves signatures, and enable you to easily access named arguments.</li>
</ul>
<h2 id="see-also">See Also<a class="headerlink" href="#see-also" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://github.com/micheles/decorator">decorator</a>, which largely inspired this code</li>
<li><a href="https://www.python.org/dev/peps/pep-0362">PEP362 - Function Signature Object</a> </li>
<li><a href="http://block.arch.ethz.ch/blog/2016/11/creating-functions-dynamically/">A blog entry on dynamic function creation</a></li>
<li><a href="https://docs.python.org/3/library/functools.html#functools.wraps">functools.wraps</a></li>
</ul>
<h3 id="others">Others<a class="headerlink" href="#others" title="Permanent link">&para;</a></h3>
<p><em>Do you like this library ? You might also like <a href="https://github.com/smarie/OVERVIEW#python">my other python libraries</a></em> </p>
<h2 id="want-to-contribute">Want to contribute ?<a class="headerlink" href="#want-to-contribute" title="Permanent link">&para;</a></h2>
<p>Details on the github page: <a href="https://github.com/smarie/python-makefun">https://github.com/smarie/python-makefun</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": [], "search": "assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>